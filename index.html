<!DOCTYPE html>

<html>

<head>

	<title>Boston Transportation Map</title>

	<meta name="viewport"
	content="width=device-width, initial-scale=1.0">

	<meta charset="utf-8">

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  	<script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.0/papaparse.min.js"></script>

	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css">
   <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>

	<script src='https://api.mapbox.com/mapbox.js/v3.3.1/mapbox.js'></script>
    <link href='https://api.mapbox.com/mapbox.js/v3.3.1/mapbox.css' rel='stylesheet' />

	<style>

		#map {
			position: absolute;
			top: 0;
			bottom: 0;
			width:100%;
			height:100%;
		}

		#title {
			font-size: 2em;
			font-family: 'Ubuntu', serif;
			font-weight: bold;
			color: #696969;
			letter-spacing: .08em;
			position: fixed;
			margin-top: 0;
			top: 20px;
			left: 20px;
			padding: 15px 15px;
			background-color: rgba(255, 255, 255, 0.8);
			border: 1px hidden;
			border-radius: 3px;
			z-index: 800;
		}

		#description {
			font-size: .7em;
			font-family: 'Lora', sans-serif;
			font-weight: normal;
			color: #696969;
			position: fixed;
			top: 30%;
			left: 20px;
			width: 30%;
			padding: 10px 10px;
			background-color: rgba(255, 255, 255, 0.8);
			border: 1px hidden;
			border-radius: 3px;
			z-index: 800;
		}
		
		#author {
			font-size: .5em;
			font-family: "Lora", sans-serif;
			font-weight: normal;
			position: fixed;
			bottom: 20px;
			left: 20px;
			width: 55px;
			color: #696969;
			background-color: rgba(255, 255, 255, 0.8);
            border: 1px hidden;
            border-radius: 3px;
            z-index: 800;
		}
	
	</style>

</head>

	<body>

		<div id='map' style ='width:100%; height:100%; position:absolute;'></div>

		<h1 id= 'title'>
			Boston Transportation Map
		</h1>

		<h2 id= 'description'>
			<p>"Boston" does not necessarily refer to the area within city limits.</p>
      		<p>People often use the include the suburbs since it feels like a single urban region. It is not helped that the neighborhoods within Boston are significantly different from one another and often separated by major freeways. With an infrastructure geared so heavily in favor of cars, the transition between city and suburb barely unnoticeable.</p>
      		<p>The gray-scale choropleth map layer shows population density across the metro area. Seeing as population density is not higher in Boston city proper, transportation from and across suburbs is critical.
      		<p>The highways, in red, are designed to transport drivers into the city from the periphery and connect the periphery in a series of concentric circles emanating from the city. In this manner, the highways create zones and loops that determine proximity and accessibility to the city.</p>
      		<p>The Boston Metro area is unfortunately known for its heavy traffic and poor public transit infrastructure. The line lines and dots show, respectively, bus lines and stops and connect towns and neighbourhoods within the highway zones.</p>
		</h2>
		
		<h3 id='author'>
			Claire Craig
		</h3>

		<script>

			var map=L.map('map',{
				center:[42.35, -71.15229363080779],
				zoom:11
				});

			L.mapbox.accessToken = 'pk.eyJ1IjoiY2xhaXJlLWNnIiwiYSI6ImNrbnA3bjZxdTAwOHQyb3FwdXhhbDM5d3cifQ.cX3_pLwyHaV0y3N6_X6yaw';

			var mapboxTiles = L.tileLayer('https://api.mapbox.com/styles/v1/mapbox/light-v10/tiles/{z}/{x}/{y}?access_token=' + L.mapbox.accessToken, {
		         attribution: '© <a href="https://www.mapbox.com/feedback/">Mapbox</a> © <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
				maxZoom: 22,
				});
			map.addLayer(mapboxTiles);

			var layer = L.mapbox.tileLayer('mapbox://styles/claire-cg/cko6ja389164d19rtsfc704wy')
				.on('ready', function() {
					var TileJSON = layer.getTileJson();
				});
			map.addLayer(mapboxTiles);

			var geojsonMarkerOptions = {
				radius: 3,
				fillColor: "#C4DDEE",
				color: "#C4DDEE",
				weight: 1,
				opacity: 0.8,
				fillOpacity: 0.8,
			};

			$.getJSON("data/busRoutes.geojson",function(data){
				L.geoJson(data, {
					onEachFeature: function(feature,layer){
						layer.bindPopup(feature.properties.MBTA_ROUTE),
					{color: "#C4DDEE", opacity: 0.5, weight: 2};
					}
				}).addTo(map);
			});

			$.getJSON("data/busStops.geojson",function(data){	
				L.geoJson(data, {
					pointToLayer: function(feature,latlng){
						return L.circleMarker(latlng,geojsonMarkerOptions);
					}
				}).addTo(map);
			});

			$.getJSON("data/highways.geojson",function(data){
				L.geoJson(data,{color:"#DDAD7F", weight:1, opacity: 0.9, fillOpacity:0}).addTo(map);
			});


			 $.get('data/data.csv', function(csvString) {

		    var data = Papa.parse(csvString, {header: true, dynamicTyping: true}).data;

		    for (var i in data) {
		      var row = data[i];

		      var popupContent="<p>"+row.city+"<p>"+"Total workers:"+row.tot_workers_over16+"<p>"+"Workers who drove alone in a car, truck, or van:"+row.alone_car_truck_van+"<p>"+"Workers who carpooled:"+row.carpool_car_truck_van+"<p>"+"Workers who used public transit:"+row.pub_trans+"<p>";

		      var marker = L.marker([row.latitude, row.longitude], {
		        opacity: 0.8,
		        icon: L.icon({
		        	iconUrl: 'image/car.png',
		        	iconSize: [40,40]})
		      }).bindPopup(popupContent);
		      
		      marker.addTo(map);
		    }
		  });

		</script>

	</body>

</html>

