<!DOCTYPE html>

<html>

<head>

	<title>Boston Transportation Map</title>

	<meta name="viewport"
	content="width=device-width, initial-scale=1.0">

	<meta charset="utf-8">

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

	<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  	<script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.0/papaparse.min.js"></script>

	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
   integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
   crossorigin=""/>
   <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
   integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
   crossorigin=""></script>

	<script src='https://api.mapbox.com/mapbox.js/v3.3.1/mapbox.js'></script>
    <link href='https://api.mapbox.com/mapbox.js/v3.3.1/mapbox.css' rel='stylesheet' />

	<style>

				#title h1{
			font-size: 3em;
			font-family: 'Ubuntu', serif;
			font-weight: bold;
			color: #696969;
			letter-spacing: .08em;
			position: fixed;
			margin-top: 0;
			top: 20px;
			left: 55px;
			padding: 15px 15px;
			background-color: rgba(255, 255, 255, 0.8);
			border: 1px hidden;
			border-radius: 3px;
			z-index: 800;
		}
		
		#author h2{
			font-size: 1em;
			font-family: "Lora", sans-serif;
			position: fixed;
			bottom: 20px;
			left: 20px;
			width: 50px;
			color: #696969;
		}

		#map {
			position: absolute;
			top: 0;
			bottom: 0;
			width:100%;
			height:100%;
		}
	
	
	</style>

</head>

	<body>

		<div id='map'></div>

		<h1 id= 'title'>
			Boston Transportation Map
		</h1>
		
		<h2 id='author'>
			Claire Craig
		</h2>

		<script>

			var map=L.map('map',{
				center:[42.35, -71.15229363080779],
				zoom:11
				});

			L.mapbox.accessToken = 'pk.eyJ1IjoiY2xhaXJlLWNnIiwiYSI6ImNrbnA3bjZxdTAwOHQyb3FwdXhhbDM5d3cifQ.cX3_pLwyHaV0y3N6_X6yaw';

			var mapboxTiles = L.tileLayer('https://api.mapbox.com/styles/v1/mapbox/light-v10/tiles/{z}/{x}/{y}?access_token=' + L.mapbox.accessToken, {
		         attribution: '© <a href="https://www.mapbox.com/feedback/">Mapbox</a> © <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
				maxZoom: 22,
				});

			map.addLayer(mapboxTiles);

			var geojsonMarkerOptions = {
				radius: 3,
				fillColor: "#C4DDEE",
				color: "#C4DDEE",
				weight: 1,
				opacity: 0.8,
				fillOpacity: 0.8,
			};

			

			$.getJSON("data/busRoutes.geojson",function(data){
				L.geoJson(data, {
					onEachFeature: function(feature,layer){
						layer.bindPopup(feature.properties.MBTA_ROUTE),
					{color: "#C4DDEE", opacity: 0.5, weight: 2};
					}
				}).addTo(map);
			});

			$.getJSON("data/busStops.geojson",function(data){	
				L.geoJson(data, {
					pointToLayer: function(feature,latlng){
						return L.circleMarker(latlng,geojsonMarkerOptions);
					}
				}).addTo(map);
			});

			$.getJSON("data/highways.geojson",function(data){
				L.geoJson(data,{color:"#DDAD7F", weight:1, opacity: 0.9, fillOpacity:0}).addTo(map);
			});


			 $.get('./data.csv', function(csvString) {

		    var data = Papa.parse(csvString, {header: true, dynamicTyping: true}).data;

		    for (var i in data) {
		      var row = data[i];

		      var popupContent="<p>"+row.city+"<p>"+"Total workers:"+row.tot_workers_over16+"<p>"+"Workers who drove alone in a car, truck, or van:"+row.alone_car_truck_van+"<p>"+"Workers who carpooled:"+row.carpool_car_truck_van+"<p>"+"Workers who used public transit:"+row.pub_trans+"<p>";

		      var marker = L.marker([row.latitude, row.longitude], {
		        opacity: 0.8,
		        icon: L.icon({
		        	iconUrl: 'image/car.png',
		        	iconSize: [40,40]})
		      }).bindPopup(popupContent);
		      
		      marker.addTo(map);
		    }

		  });

			var bosPnt = L.marker ([42.3601,-71.0589]).addTo(map);
			var camPnt = L.marker ([42.3736,-71.1097]).addTo(map);
			var lynnPnt = L.marker ([42.4668,-70.9495]).addTo(map);
			var newtPnt = L.marker ([42.337,-71.2092]).addTo(map);			
			var qncPnt = L.marker ([42.2529,-71.0023]).addTo(map);
			var somPnt = L.marker ([42.3876,-71.0995]).addTo(map);

		</script>

	</body>

</html>

